stages:
  - build
  - deploy

image: docker:20
services:
  - docker:20-dind

build:
  stage: build
  script:
    - docker build -t ${NAME_OF_IMAGE} .
    - docker push ${NAME_OF_IMAGE}
  only:
    - develop

deploy:
  stage: deploy
  script:
    - docker-compose up -d
  only:
    - develop

